# Media Server Helm Chart Values

# Jellyfin Configuration
jellyfin:
  enabled: true
  replicaCount: 1
  
  image:
    repository: jellyfin/jellyfin
    tag: "10.9.11"
    pullPolicy: IfNotPresent
  
  # Automated configuration
  config:
    autoSetup: false
    serverName: "Jellyfin Media Server"
    publicUrl: "https://jellyfin.cace-1-dev.dramisinfo.com"
    # Initial admin user (manual setup via wizard)
    adminUser:
      enabled: false
      username: "admin"
      password: "truenas"  # Change this!
    
    # Media libraries to create automatically
    libraries:
      - name: "Movies"
        type: "movies"
        paths:
          - "/media/movies"
      - name: "TV Shows"
        type: "tvshows"
        paths:
          - "/media/shows"
  
  service:
    type: ClusterIP
    port: 8096
    annotations: {}
  
  ingress:
    enabled: true
    className: "nginx"
    annotations:
      cert-manager.io/cluster-issuer: "letsencrypt-prd"
      nginx.ingress.kubernetes.io/proxy-body-size: "0"
      nginx.ingress.kubernetes.io/proxy-read-timeout: "600"
      nginx.ingress.kubernetes.io/proxy-send-timeout: "600"
    hosts:
      - host: jellyfin.cace-1-dev.dramisinfo.com
        paths:
          - path: /
            pathType: Prefix
    tls:
      - secretName: jellyfin-tls
        hosts:
          - jellyfin.cace-1-dev.dramisinfo.com
  
  persistence:
    config:
      enabled: true
      storageClass: ""
      accessMode: ReadWriteOnce
      size: 10Gi
      # existingClaim: ""
    
    # Media storage - supports SMB/CIFS, NFS, or PVC
    media:
      type: smb  # Options: smb, nfs, pvc, hostPath
      mountPath: /media
      readOnly: false
      
      # SMB/CIFS Configuration
      smb:
        server: "192.168.2.30"  # e.g., 192.168.1.100
        share: "/medias"   # e.g., /media or //server/media
        # Credentials stored in a secret
        secretName: ""  # If empty, will create one named: {release}-jellyfin-smb
        # Set these if secretName is empty (will create secret automatically)
        username: "truenas"
        password: "truenas"
        domain: ""
        options: "vers=3.0,file_mode=0755,dir_mode=0755"
      
      # NFS Configuration (alternative)
      nfs:
        server: ""
        path: ""
        options: "rw,nfsvers=4.1"
      
      # HostPath Configuration (alternative)
      hostPath:
        path: "/mnt/media"
        type: Directory
      
      # PVC Configuration (alternative)
      pvc:
        enabled: false
        storageClass: ""
        accessMode: ReadWriteMany
        size: 100Gi
        existingClaim: ""
    
    cache:
      # Use emptyDir by default (lost on restart but saves space)
      type: emptyDir  # Options: emptyDir, pvc
      emptyDir:
        sizeLimit: 5Gi
      pvc:
        enabled: false
        storageClass: ""
        accessMode: ReadWriteOnce
        size: 5Gi
        existingClaim: ""
  
  resources:
    requests:
      memory: "512Mi"
      cpu: "250m"
    limits:
      memory: "1Gi"
      cpu: "1000m"
  
  nodeSelector: {}
  
  tolerations: []
  
  affinity: {}
  
  env: []
    # - name: JELLYFIN_PublishedServerUrl
    #   value: "https://jellyfin.example.com"
